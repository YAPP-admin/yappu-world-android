package com.yapp.feature.notice.noticedetail

import android.util.Log
import androidx.lifecycle.SavedStateHandle
import androidx.lifecycle.ViewModel
import com.yapp.core.ui.mvi.MviIntentStore
import com.yapp.core.ui.mvi.mviIntentStore
import dagger.hilt.android.lifecycle.HiltViewModel
import javax.inject.Inject

@HiltViewModel
class NoticeDetailViewModel @Inject constructor(
    savedStateHandle: SavedStateHandle,
) : ViewModel() {
    val store: MviIntentStore<NoticeDetailState, NoticeDetailIntent, NoticeDetailSideEffect> =
        mviIntentStore(
            initialState = NoticeDetailState(),
            onIntent = ::onIntent
        )

    private val noticeId: String =
        requireNotNull(savedStateHandle.get<String>(NOTICE_ID_KEY)) { "noticeId is required." }

    private fun onIntent(
        intent: NoticeDetailIntent,
        state: NoticeDetailState,
        reduce: (NoticeDetailState.() -> NoticeDetailState) -> Unit,
        postSideEffect: (NoticeDetailSideEffect) -> Unit
    ) {
        when (intent) {
            NoticeDetailIntent.ClickBackButton -> TODO()
            NoticeDetailIntent.EnterScreen -> {
                reduce {
                    copy(dummyData = markdown1)
                }
            }
        }
    }

    companion object {
        private const val NOTICE_ID_KEY = "noticeId"
    }
}

val markdown1 = """
# 수수 - 경조사비 기록 장부

![graphic_image](https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/ed04eee2-7c77-42b2-98e7-21154975418b)

<a href="https://play.google.com/store/apps/details?id=com.oksusu.susu" target="_blank">
<img src="https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/dc6a36dc-7317-48fc-8acb-fbf998fadb37" width="200" /></a>


> 결혼식, 돌잔치, 장례식, 생일 같은 경조사를 챙긴 적 있나요?
> 주고받은 소중한 마음들, 수수와 함께 경조사비를 똑똑하게 관리해요!

---

## Project Structure

<img width="800" alt="structure" src="https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/1fa16d85-7d93-4c93-94a2-e73be7bf4e16">

## Tech Stack

| Tech Stack    |                                                     |
|:--------------|:----------------------------------------------------|
| Architecture  | MVI, Clean Architecture                             |
| Compose       | Navigation, Kotlinx.Immutable                       |
| DI            | Hilt                                                |
| Network       | Retrofit2, OkHttp3                                  |
| Asynchronous  | Coroutine, Flow                                     |
| Jetpack       | Room, DataStore, ViewModel                          |
| CI            | Github Actions                                      |
| ETC           | Kakao SDK, Firebase Crashlytics, Firebase Analytics |

## About 수수

### ✉️ 보내요 / 받아요

- 인물 / 경조사 별로 주고 받은 경조사비를 확인해요
- 금액, 관계, 방문여부 등 원하는 내용을 기록해요
- 필터를 걸어서 원하는 기록만 확인해요
- 기억이 안 날 땐 검색을 활용해요

<img src="https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/5cf1a4b4-18b3-439b-b9a3-ddbdefa62bec" width = "360"/>
<img src="https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/cb37f518-df94-47da-8667-5db5e5ff49cd" width = "360"/>


### 📊 통계

- 내 경조사비 소비가 궁금할 땐, '나의 통계'
  - 최근 8개월 간 주고받은 금액
  - 나와 가장 많은 금액을 주고 받은 인물은 누구일까요?
- 다른 사람들의 경조사비 소비가 궁금할 땐, '수수 통계'
  - 연령대, 관계, 경조사에 따른 평균 경조사비 데이터
  - 사람들이 가장 많이 주고 받는 경조사, 금액은 얼마일까요?

<img src="https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/6244f8e7-f335-4456-83c8-a4528482a990" width = "360"/>
<img src="https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/8e196bae-cfe3-4968-a9ec-a2b7b3ce33a9" width = "360"/>


### 💬 커뮤니티

- 경조사비에 대한 사람들의 생각을 확인해요
  - 경조사에 관한 고민을 익명 투표로 올려요
  - 사람들의 고민에 익명으로 투표해요
  - 보기 싫은 투표와 유저는 차단, 신고할 수 있어요

<img src="https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/d8de2587-b8ca-49ad-b481-c6e479497cb2" width = "360"/>
<img src="https://github.com/YAPP-Github/oksusu-susu-android/assets/69582122/77821689-fca1-4ad8-afe4-57770fc46290" width = "360"/>


## Developer

| [이진욱](https://github.com/jinukeu)                                              | [양수진](https://github.com/yangsooplus)                                          | [신예빈](https://github.com/syb8200)                                              |
|--------------------------------------------------------------------------------|--------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| ![image](https://avatars.githubusercontent.com/u/81678959?v=4)| ![image](https://avatars.githubusercontent.com/u/69582122?v=4) | ![image](https://avatars.githubusercontent.com/u/70886911?v=4) |


""".trimIndent()
